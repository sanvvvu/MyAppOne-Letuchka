<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:MyTestOne.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:models="using:MyTestOne.Models"
        mc:Ignorable="d"
        x:DataType="vm:MainWindowViewModel"
        x:Class="MyTestOne.Views.MainWindow"
        Title="MyTestOne" Width="800" Height="600">
    
    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <Grid ColumnDefinitions="300,*" RowDefinitions="Auto,*">
        <!-- Панель управления -->
        <StackPanel Grid.Column="0" Grid.RowSpan="2" Background="#f0f0f0">
            <StackPanel Margin="15">
                <!-- Переключение фигур -->
                <TextBlock Text="Выберите фигуру:" Margin="0,0,0,10" FontWeight="Bold"/>
                <StackPanel Orientation="Horizontal" Spacing="10">
                    <Button Content="Прямоугольник" Command="{Binding SwitchToRectangleCommand}" Width="120"/>
                    <Button Content="Круг" Command="{Binding SwitchToCircleCommand}" Width="120"/>
                </StackPanel>

                <!-- Общие параметры -->
                <TextBlock Text="Общие параметры:" Margin="0,20,0,10" FontWeight="Bold"/>
                <TextBlock Text="Цвет фигуры:"/>
                <Border Background="{Binding CurrentSettings.ShapeColor}" Height="30" Margin="0,5,0,15"/>
                
                <TextBlock Text="Текст:" Margin="0,10,0,0"/>
                <TextBox Text="{Binding CurrentSettings.Text}" Width="200"/>
                
                <TextBlock Text="Цвет текста:" Margin="0,10,0,0"/>
                <Border Background="{Binding CurrentSettings.TextColor}" Height="30" Margin="0,5,0,15"/>

                <!-- Специфичные параметры -->
                <TextBlock Text="Специфичные параметры:" Margin="0,20,0,10" FontWeight="Bold"/>
                
                <!-- Для прямоугольника -->
                <StackPanel x:Name="rectPanel" IsVisible="{Binding CurrentShapeType, Converter={x:Static ObjectConverters.IsEqual}, ConverterParameter={x:Static models:ShapeType.Rectangle}}">
                    <TextBlock Text="Ширина:"/>
                    <Slider Minimum="50" Maximum="400" Value="{Binding RectangleSettings.Width}" Width="200"/>
                    
                    <TextBlock Text="Высота:" Margin="0,10,0,0"/>
                    <Slider Minimum="50" Maximum="400" Value="{Binding RectangleSettings.Height}" Width="200"/>
                    
                    <TextBlock Text="Поворот (градусы):" Margin="0,10,0,0"/>
                    <Slider Minimum="0" Maximum="360" Value="{Binding RectangleSettings.Rotation}" Width="200"/>
                </StackPanel>
                
                <!-- Для круга -->
                <StackPanel x:Name="circlePanel" IsVisible="{Binding CurrentShapeType, Converter={x:Static ObjectConverters.IsEqual}, ConverterParameter={x:Static models:ShapeType.Circle}}">
                    <TextBlock Text="Сжатие по X:"/>
                    <Slider Minimum="0.1" Maximum="2.0" Value="{Binding CircleSettings.ScaleX}" Width="200"/>
                    
                    <TextBlock Text="Сжатие по Y:" Margin="0,10,0,0"/>
                    <Slider Minimum="0.1" Maximum="2.0" Value="{Binding CircleSettings.ScaleY}" Width="200"/>
                </StackPanel>
            </StackPanel>
        </StackPanel>
        
        <!-- Область отображения -->
        <Border Grid.Column="1" Grid.Row="0" Background="White" Padding="20">
            <ContentControl Content="{Binding}">
                <ContentControl.ContentTemplate>
                    <DataTemplate>
                        <Canvas Width="300" Height="300">
                            <!-- Прямоугольник -->
                            <Rectangle Fill="{Binding RectangleSettings.ShapeColor}" 
                                       Width="{Binding RectangleSettings.Width}" 
                                       Height="{Binding RectangleSettings.Height}"
                                       RenderTransformOrigin="0.5,0.5"
                                       IsVisible="{Binding CurrentShapeType, Converter={x:Static ObjectConverters.IsEqual}, ConverterParameter={x:Static models:ShapeType.Rectangle}}">
                                <Rectangle.RenderTransform>
                                    <RotateTransform Angle="{Binding RectangleSettings.Rotation}"/>
                                </Rectangle.RenderTransform>
                                <TextBlock Text="{Binding RectangleSettings.Text}" 
                                           Foreground="{Binding RectangleSettings.TextColor}"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                            </Rectangle>
                            
                            <!-- Круг -->
                            <Ellipse Fill="{Binding CircleSettings.ShapeColor}"
                                     Width="150" Height="150"
                                     RenderTransformOrigin="0.5,0.5"
                                     IsVisible="{Binding CurrentShapeType, Converter={x:Static ObjectConverters.IsEqual}, ConverterParameter={x:Static models:ShapeType.Circle}}">
                                <Ellipse.RenderTransform>
                                    <ScaleTransform ScaleX="{Binding CircleSettings.ScaleX}" 
                                                    ScaleY="{Binding CircleSettings.ScaleY}"/>
                                </Ellipse.RenderTransform>
                                <TextBlock Text="{Binding CircleSettings.Text}" 
                                           Foreground="{Binding CircleSettings.TextColor}"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                            </Ellipse>
                        </Canvas>
                    </DataTemplate>
                </ContentControl.ContentTemplate>
            </ContentControl>
        </Border>
    </Grid>
</Window>